(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){},30:function(e,t,a){e.exports=a(51)},35:function(e,t,a){},39:function(e,t,a){},41:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(25),o=a.n(i),c=a(9),l=(a(35),a(10)),s=a.n(l),u=a(14),d=a(1),m=a(2),h=a(5),p=a(4),g=a(6),f=a(11),b=(a(39),a(41),function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("header",null,r.a.createElement("nav",null,r.a.createElement("h1",null,"CASTING AGENCY")))}}]),t}(n.Component)),v=a(15),y=a(7),E=a.n(y),k=a(26),w=a(27),j=a.n(w),O=new(function(){function e(){Object(d.a)(this,e),this.auth0=new k.a.WebAuth({domain:"dev-6id39aor.auth0.com",audience:"castingapi",clientID:"KdG7NgFNyBEdKo0SqE2WRWciKmyDSUqe",redirectUri:"https://yonyalva.github.io/castingagency/callback",responseType:"token id_token",scope:"openid profile"}),this.getProfile=this.getProfile.bind(this),this.handleAuthentication=this.handleAuthentication.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this),this.signIn=this.signIn.bind(this),this.signOut=this.signOut.bind(this)}return Object(m.a)(e,[{key:"getProfile",value:function(){return this.profile}},{key:"getIdToken",value:function(){return this.idToken}},{key:"getToken",value:function(){return localStorage.getItem("JWTS_LOCAL_KEY")}},{key:"getPermission",value:function(){return this.payload}},{key:"isAuthenticated",value:function(){return(new Date).getTime()<this.expiresAt}},{key:"signIn",value:function(){this.auth0.authorize()}},{key:"check_token_fragment",value:function(){var e=window.location.hash.substr(1).split("&")[0].split("=");"access_token"===e[0]&&(this.token=e[1],this.set_jwt())}},{key:"set_jwt",value:function(){localStorage.setItem("JWTS_LOCAL_KEY",this.token),this.token&&this.decodeJWT(this.token)}},{key:"load_jwts",value:function(){this.token=localStorage.getItem("JWTS_LOCAL_KEY")||null,this.token&&this.decodeJWT(this.token)}},{key:"decodeJWT",value:function(e){return this.payload=j()(this.token),this.payload}},{key:"handleAuthentication",value:function(){var e=this;return new Promise(function(t,a){e.auth0.parseHash(function(n,r){return n?a(n):r&&r.idToken?(e.setSession(r),void t()):a(n)})})}},{key:"setSession",value:function(e){this.idToken=e.idToken,this.profile=e.idTokenPayload,this.expiresAt=1e3*e.idTokenPayload.exp}},{key:"signOut",value:function(){this.auth0.logout({returnTo:"https://yonyalva.github.io/castingagency/",clientID:"KdG7NgFNyBEdKo0SqE2WRWciKmyDSUqe"}),localStorage.removeItem("JWTS_LOCAL_KEY")}},{key:"silentAuth",value:function(){var e=this;return new Promise(function(t,a){e.auth0.checkSession({},function(n,r){if(n)return a(n);e.setSession(r),t()})})}},{key:"can",value:function(e){return this.payload&&this.payload.permissions&&this.payload.permissions.length&&this.payload.permissions.indexOf(e)>=0}}]),e}()),C=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).getMovies=function(){E.a.ajax({url:"https://castingya.herokuapp.com/movies",type:"GET",success:function(e){a.setState({movies:e.movies})},error:function(e){alert("Unable to load movies. Please try your request again")}})},a.movieAction=function(e){return function(t){"DELETE"===t&&window.confirm("are you sure you want to delete this movie?")&&E.a.ajax({url:"https://castingya.herokuapp.com/movies/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"DELETE",success:function(e){a.getMovies()},error:function(e){alert("Unable to delete the movie. Please try your request again")}})}},a.updateMovie=function(e){return function(t){t.preventDefault(),E.a.ajax({url:"https://castingya.herokuapp.com/movies/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify({title:a.state.title,release_date:a.state.release_date}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){window.location.reload(!1)},error:function(e){alert("Unable to update the movie. Please try your request again")}})}},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.showform=function(e){var t=a.state.movies.filter(function(t){return t.id===e.id})[0];document.querySelector("#title").value=t.title,document.querySelector("#release_date").value=t.release_date;var n=document.querySelector("#id").value=t.id;E()(".form-visible").show(),E()(".dborder3").hide(),E()(".button-visible").hide(),a.setState({id:n})},a.state={movies:[]},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMovies();case 2:return e.next=4,O.load_jwts();case 4:return e.next=6,O.check_token_fragment();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.id;return r.a.createElement("div",{id:"display"},r.a.createElement("div",{className:"dborder boxshw cardwi",id:"someDivId"},O.can("post:movies")&&r.a.createElement(c.b,{to:"/castingagency/addmovie"},r.a.createElement("button",{type:"button",className:"button-visible",title:"add a new movie"},"Add a new movie")),r.a.createElement("form",{className:"form-view form-visible",onSubmit:this.updateMovie(t)},r.a.createElement("label",null,"Title",r.a.createElement("input",{type:"text",name:"title",id:"title",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Release date",r.a.createElement("input",{type:"date",name:"release_date",id:"release_date",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Id",r.a.createElement("input",{type:"text",size:"4",name:"id",id:"id",onChange:this.handleChange,readOnly:!0})),r.a.createElement("input",{type:"submit",className:"button",value:"Save"})),this.state.movies&&this.state.movies.map(function(t,a){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"dborder3"},r.a.createElement("ul",{className:"listnone"},r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Title"),": ",r.a.createElement("span",null,t.title),O.can("patch:movies")&&r.a.createElement("img",{src:"../images/edit.png",alt:"edit",title:"Edit this movie",className:"edit",onClick:function(){return e.showform(t)}})),r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Release date"),": ",r.a.createElement("span",null,t.release_date),O.can("delete:movies")&&r.a.createElement("img",{src:"../images/delete.png",alt:"delete",title:"Delete this movie",className:"delete",onClick:function(){return e.movieAction(t.id)("DELETE")}})))))})))}}]),t}(n.Component),A=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).getActors=function(){E.a.ajax({url:"https://castingya.herokuapp.com/actors",type:"GET",success:function(e){a.setState({actors:e.actors})},error:function(e){alert("Unable to load actors. Please try your request again")}})},a.actorAction=function(e){return function(t){"DELETE"===t&&window.confirm("are you sure you want to delete this actor?")&&E.a.ajax({url:"https://castingya.herokuapp.com/actors/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"DELETE",success:function(e){a.getActors()},error:function(e){alert("Unable to delete the actor. Please try your request again")}})}},a.updateActor=function(e){return function(t){t.preventDefault(),E.a.ajax({url:"https://castingya.herokuapp.com/actors/".concat(e),headers:{Authorization:"Bearer ".concat(O.getToken())},type:"PATCH",dataType:"json",contentType:"application/json",data:JSON.stringify({name:a.state.name,age:a.state.age,gender:a.state.gender}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){window.location.reload(!1)},error:function(e){alert("Unable to update the actor. Please try your request again")}})}},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.showform=function(e){var t=a.state.actors.filter(function(t){return t.id===e.id})[0];document.querySelector("#name").value=t.name,document.querySelector("#age").value=t.age,document.querySelector("#gender").value=t.gender;var n=document.querySelector("#id").value=t.id;E()(".form-visible").show(),E()(".dborder3").hide(),E()(".button-visible").hide(),a.setState({id:n})},a.state={actors:[]},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getActors();case 2:return e.next=4,O.load_jwts();case 4:return e.next=6,O.check_token_fragment();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.id;return r.a.createElement("div",{id:"display"},r.a.createElement("div",{className:"dborder boxshw cardwi"},O.can("post:actors")&&r.a.createElement(c.b,{to:"/castingagency/addactor"},r.a.createElement("button",{type:"button",className:"button-visible",title:"add a new actor"},"Add a new actor")),r.a.createElement("form",{className:"form-view form-visible",onSubmit:this.updateActor(t)},r.a.createElement("label",null,"Name",r.a.createElement("input",{type:"text",name:"name",id:"name",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Age",r.a.createElement("input",{type:"number",name:"age",id:"age",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Gender",r.a.createElement("input",{type:"text",name:"gender",id:"gender",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Id",r.a.createElement("input",{type:"text",size:"4",name:"id",id:"id",onChange:this.handleChange,readOnly:!0})),r.a.createElement("input",{type:"submit",className:"button",value:"Save"})),this.state.actors&&this.state.actors.map(function(t,a){return r.a.createElement("div",{key:t.id},r.a.createElement("div",{className:"dborder3"},r.a.createElement("ul",{className:"listnone"},r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Name"),": ",r.a.createElement("span",{id:"name"},t.name),O.can("patch:actors")&&r.a.createElement("img",{src:"../images/edit.png",alt:"edit",title:"Edit this actor",className:"edit",onClick:function(){return e.showform(t)}})),r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Age"),": ",r.a.createElement("span",{id:"age"},t.age)),r.a.createElement("li",null,r.a.createElement("span",{className:"listbold"},"Gender"),": ",r.a.createElement("span",{id:"gender"},t.gender),O.can("delete:actors")&&r.a.createElement("img",{src:"../images/delete.png",alt:"delete",title:"Delete this actor",className:"delete",onClick:function(){return e.actorAction(t.id)("DELETE")}})))))})))}}]),t}(n.Component),S=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(e){return r.a.createElement("div",{className:"options-box"},r.a.createElement(c.b,{to:"/casting/"},r.a.createElement("div",{align:"center",role:"listitem",tabIndex:"4",className:"sidebar-item"},r.a.createElement("strong",null,"Movies"),r.a.createElement("br",null),r.a.createElement("img",{src:"../images/movies.png",alt:"movies"}))),r.a.createElement(c.b,{to:"/casting/actors"},r.a.createElement("div",{align:"center",role:"listitem",tabIndex:"5",className:"sidebar-item"},r.a.createElement("strong",null,"Actors"),r.a.createElement("br",null),r.a.createElement("img",{src:"../images/actors.jpg",alt:"actors"}))),r.a.createElement("div",{align:"center",role:"listitem",tabIndex:"6",className:"sidebar-item"},!O.isAuthenticated()&&r.a.createElement("button",{onClick:O.signIn},"Sign In"),O.isAuthenticated()&&r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){O.signOut(),e.history.replace("/")}},"Sign Out"),r.a.createElement("label",null,O.getProfile().name))))}}]),t}(n.Component),x=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{id:"footer"},r.a.createElement("strong",null,"Casting Agency"),". Made with ",r.a.createElement("strong",null,"React & Flask API"))}}]),t}(n.Component),T=(a(24),function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this))).submitMovie=function(e){e.preventDefault(),E.a.ajax({url:"https://castingya.herokuapp.com/movies_new",headers:{Authorization:"Bearer ".concat(O.getToken())},type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({title:a.state.title,release_date:a.state.release_date}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){document.getElementById("add-movie-form").reset()},error:function(e){alert("Unable to add the movie. Please try your request again")}})},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.state={title:"",release_date:""},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"add-form"},r.a.createElement("h2",null,"Add a new movie"),r.a.createElement("form",{className:"form-view",id:"add-movie-form",onSubmit:this.submitMovie},r.a.createElement("label",null,"Title",r.a.createElement("input",{type:"text",name:"title",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Release date",r.a.createElement("input",{type:"date",name:"release_date",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))}}]),t}(n.Component)),N=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this))).submitActor=function(e){e.preventDefault(),E.a.ajax({url:"https://castingya.herokuapp.com/actors_new",headers:{Authorization:"Bearer ".concat(O.getToken())},type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({name:a.state.name,age:a.state.age,gender:a.state.gender}),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){document.getElementById("add-actor-form").reset()},error:function(e){alert("Unable to add the actor. Please try your request again")}})},a.handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.state={name:"",age:"",gender:""},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"add-form"},r.a.createElement("h2",null,"Add a new actor"),r.a.createElement("form",{className:"form-view",id:"add-actor-form",onSubmit:this.submitActor},r.a.createElement("label",null,"Name",r.a.createElement("input",{type:"text",name:"name",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Age",r.a.createElement("input",{type:"number",name:"age",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("label",null,"Gender",r.a.createElement("input",{type:"text",name:"gender",onChange:this.handleChange,required:!0})),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"button",value:"Submit"})))}}]),t}(n.Component),_=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.handleAuthentication();case 2:return e.next=4,O.load_jwts();case 4:return e.next=6,O.check_token_fragment();case 6:this.props.history.replace("/castingagency/");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("p",null,"Loading profile...")}}]),t}(n.Component),q=Object(f.f)(_),D=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={checkingSession:!0},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("./components/callback"!==this.props.location.pathname){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,O.silentAuth();case 5:this.forceUpdate(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),"login_required"!==e.t0.error&&console.log(e.t0.error);case 11:case"end":return e.stop()}},e,this,[[2,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(c.a,null,r.a.createElement(b,null),r.a.createElement(f.c,null,r.a.createElement(f.a,{path:"/castingagency/",exact:!0,component:C}),r.a.createElement(f.a,{path:"/castingagency/actors",component:A}),r.a.createElement(f.a,{path:"/castingagency/addmovie",exact:!0,component:T}),r.a.createElement(f.a,{path:"/castingagency/addactor",component:N}),r.a.createElement(f.a,{exact:!0,path:"/castingagency/callback",component:q}),r.a.createElement(f.a,{component:C})),r.a.createElement(S,null),r.a.createElement(x,null)))}}]),t}(n.Component),P=Object(f.f)(D),I=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function W(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(c.a,null,r.a.createElement(P,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/castingagency",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/castingagency","/service-worker.js");I?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):W(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):W(t,e)})}}()}},[[30,2,1]]]);
//# sourceMappingURL=main.7f0dbd61.chunk.js.map